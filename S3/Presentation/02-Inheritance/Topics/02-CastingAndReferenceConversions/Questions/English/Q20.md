<div dir="ltr" style="text-align: left;">

## ‚ùì Q20:

## How do Dynamic Type and Runtime Casting work with Reflection?

### ‚úÖ Deep Answer:

`dynamic` type in C# uses **DLR (Dynamic Language Runtime)** and performs casting at runtime.

### üîç Dynamic vs Static Casting:

<div dir="ltr" style="text-align: left;">

```csharp
class Animal { }
class Dog : Animal { }

Animal animal = new Dog();

// Static Casting (Compile-time):
Dog dog1 = (Dog)animal;  // ‚úÖ Compiler knows

// Dynamic Casting (Runtime):
dynamic dyn = animal;
Dog dog2 = (Dog)dyn;  // ‚úÖ Runtime decides
```

<div dir="ltr" style="text-align: left;">

### üî¨ Dynamic Mechanism:

<div dir="ltr" style="text-align: left;">

```csharp
dynamic obj = new Dog();

// When you write this code:
obj.Bark();  // Compiler doesn't know if Bark exists!

// Runtime does these things:
// 1. Reads Type Information from object
// 2. Performs Method Lookup
// 3. If method found ‚Üí calls it
// 4. If not found ‚Üí RuntimeBinderException
```

<div dir="ltr" style="text-align: left;">

### ‚ö†Ô∏è Performance Overhead:

<div dir="ltr" style="text-align: left;">

```csharp
// Static (Compile-time):
Dog dog = (Dog)animal;  // ~1-2 CPU cycles ‚úÖ

// Dynamic (Runtime):
dynamic dyn = animal;
Dog dog2 = (Dog)dyn;  // ~100-1000 CPU cycles ‚ö†Ô∏è
// Must:
// 1. Type resolution
// 2. Method lookup
// 3. Binding
// 4. Invocation
```

<div dir="ltr" style="text-align: left;">

### üî¨ Reflection and Casting:

<div dir="ltr" style="text-align: left;">

```csharp
Animal animal = new Dog();

// With Reflection we can read Type Information:
Type type = animal.GetType();
Type targetType = typeof(Dog);

// Check if Cast is possible:
bool canCast = targetType.IsAssignableFrom(type);  // True ‚úÖ

// Or with Convert:
object converted = Convert.ChangeType(animal, typeof(Dog));  // ‚úÖ
Dog dog = (Dog)converted;
```

<div dir="ltr" style="text-align: left;">

### üìä Performance Comparison:

| Method | CPU Cycles | Type Safety |
|-----|-----------|-------------|
| **Static Cast** | ~1-2 | ‚úÖ Compile-time |
| **Dynamic Cast** | ~100-1000 | ‚ö†Ô∏è Runtime |
| **Reflection** | ~1000-10000 | ‚ö†Ô∏è Runtime |

### üéØ Advanced Points:

1. **Dynamic** uses **Call Site Caching** (faster after first call)
2. **Reflection** is very slow (must read Metadata)
3. **Static Casting** always has the best performance

### ‚ö†Ô∏è Recommendation:

Use `dynamic` only when **really necessary**! It has performance overhead.
