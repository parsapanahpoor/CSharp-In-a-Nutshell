<div dir="ltr" style="text-align: left;">

## â“ Q18:

## Field Hiding and Memory Layout - Why is it dangerous?

### âœ… Deep Answer:

Field Hiding is **very dangerous** because two separate fields are created in memory which can cause bugs.

### ğŸ” Memory Layout:

<div dir="ltr" style="text-align: left;">

```csharp
class Base {
    public int value = 10;
}

class Derived : Base {
    public new int value = 20;  // âš ï¸ Hiding field
}
```

<div dir="ltr" style="text-align: left;">

### ğŸ“Š Memory Structure:

<div dir="ltr" style="text-align: left;">

```
Derived Object in Heap:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Object Header           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Type Handle             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Base.value (int) = 10   â”‚ â† Base field
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Derived.value (int) = 20â”‚ â† Derived field (separate!)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<div dir="ltr" style="text-align: left;">

### âš ï¸ Problem:

<div dir="ltr" style="text-align: left;">

```csharp
Derived obj = new Derived();

// These two point to different fields:
Base b = obj;
b.value = 30;  // Base.value = 30 âœ…

Console.WriteLine(obj.value);  // 20! âŒ (Derived.value didn't change!)
Console.WriteLine(((Base)obj).value);  // 30 âœ… (Base.value)
```

<div dir="ltr" style="text-align: left;">

### ğŸ”¬ Why it's dangerous:

1. **Two Separate Fields**: Base.value and Derived.value are different fields
2. **Memory Waste**: Two fields are kept in memory
3. **Confusion**: Code is not readable and causes bugs
4. **No Polymorphism**: Decision is made based on reference type

### âœ… Solution:

<div dir="ltr" style="text-align: left;">

```csharp
// Instead of Field Hiding:
class Base {
    public virtual int Value { get; set; } = 10;  // âœ… Property
}

class Derived : Base {
    public override int Value {  // âœ… Override
        get => base.Value * 2;
        set => base.Value = value / 2;
    }
}
```

<div dir="ltr" style="text-align: left;">

### ğŸ¯ Advanced Note:

**Never do Field Hiding**! Use Properties with virtual/override. Field Hiding only causes confusion and bugs.

### âš ï¸ Performance:

Field Hiding has **Memory Overhead** (two fields in memory). Properties also have overhead but much less and more acceptable.
