<div dir="ltr" style="text-align: left;">

## â“ Q17:

## How does Virtual Method Resolution work in Multi-Level Inheritance?

### âœ… Deep Answer:

In Multi-Level Inheritance, VMT is created for each level and resolution is done from Derived to Base.

### ğŸ” Complex Example:

<div dir="ltr" style="text-align: left;">

```csharp
class Animal {
    public virtual void Speak() => Console.WriteLine("Animal");
}

class Mammal : Animal {
    public override void Speak() => Console.WriteLine("Mammal");
}

class Dog : Mammal {
    public override void Speak() => Console.WriteLine("Dog");
}

class Puppy : Dog {
    // Speak() not overridden
}
```

<div dir="ltr" style="text-align: left;">

### ğŸ“Š VMT Chain:

<div dir="ltr" style="text-align: left;">

```
Animal VMT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [0] Animal.Speak()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Mammal VMT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [0] Mammal.Speak()â”‚ (Override from Animal)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Dog VMT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [0] Dog.Speak()   â”‚ (Override from Mammal)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Puppy VMT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [0] Dog.Speak()   â”‚ (Inherited from Dog)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<div dir="ltr" style="text-align: left;">

### âš™ï¸ Resolution Process:

<div dir="ltr" style="text-align: left;">

```csharp
Animal animal = new Puppy();
animal.Speak();  // What happens?

// 1. Runtime reads actual type: Puppy
// 2. Goes to Puppy VMT
// 3. Reads index [0] â†’ Dog.Speak()
// 4. Dog.Speak() executes âœ…
```

<div dir="ltr" style="text-align: left;">

### ğŸ”¬ Virtual Override Chain:

<div dir="ltr" style="text-align: left;">

```csharp
class Puppy : Dog {
    public override void Speak() {
        Console.WriteLine("Puppy");
        base.Speak();  // âœ… Dog.Speak() is called
    }
}

Animal animal = new Puppy();
animal.Speak();
// Output:
// Puppy
// Dog
```

<div dir="ltr" style="text-align: left;">

### ğŸ¯ Advanced Note:

`base` keyword always refers to **direct Base Class**, not GrandParent. To access GrandParent, you must use `((GrandParent)this).Method()`.

### âš ï¸ Limitation:

`base.base` doesn't exist! Only goes one level up.
